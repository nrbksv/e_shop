{% extends 'base.html' %}

{% block content %}
    {% include 'partial/nav_bar.html' %}
    <table class="table table-striped border-0">
      <thead>
        <tr class="border-0">
          <th scope="col">
              <ul class="nav-bar nav">
                <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle c-link t-link" href="#" id="navbarDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    Категория
                  </a>
                  <ul class="px-2 dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                    <a class="c-link" href="{% url 'shop:product-list' %}"><li class="py-1">Все</li></a>
                      {% for category in categories %}
                    <a class="c-link t-link" href="{% url 'shop:product-list'  %}?product/category={{ category.id }}"><li class="py-1">{{ category.category }}</li></a>
                      {% endfor %}
                  </ul>
                </li>
              </ul>
          </th>
          <th class="align-middle t-link" scope="col">Наименование</th>
          <th class="align-middle t-link" scope="col">Цена</th>
            <th class="align-middle t-link" scope="col">
                {% if qty %}
                    <a class="btn btn-warning btn-sm" href="{% url 'shop:cart-products-list' %}">
                        <i class="fas fa-shopping-cart"> в корзине: <span class="badge rounded-pill bg-light text-dark">{{ qty }}</span></i>
                    </a>
                {%  endif %}
            </th>
        </tr>
      </thead>
      <tbody class="border-0">
          {% for product in products %}
            <tr>
              <td class="pl-4"><a class="product-link" href="{% url 'shop:product-list' %}?product/category={{ product.category.id }}">{{ product.category }}</a></td>
              <td><a class="product-link" href="{% url 'shop:product-detail' product.id %}">{{ product.product | truncatechars_html:40  }}</a></td>
              <td>{{ product.price }}</td>
                <td>
              <form action="{% url 'shop:add-to-cart' product.id %}" method="GET">
                  <input type="number" name="qty" value="1" style="width: 50px">
                  <button class="btn btn-warning btn-sm text-dark" name="prev" value="{{ request.get_full_path }}" type="submit"><i class="fas fa-cart-plus">  в корзину</i></button>
              </form>
                </td>
{#                <td><a class="btn btn-warning btn-sm text-dark" href="{% url 'shop:add-to-cart' product.id %}?prev={{ request.get_full_path }}"><i class="fas fa-cart-plus">  в корзину</i></a></td>#}
            </tr>
          {% empty %}
          <tr><td>Нет товаров</td></tr>
          {% endfor %}
      </tbody>
    </table>
    {% if is_paginated %}
        {% include 'partial/paginate.html' %}
    {% endif %}
{% endblock %}